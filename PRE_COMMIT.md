# Pre-commit Hooks - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ß—Ç–æ —ç—Ç–æ?

Pre-commit hooks –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∞—à –∫–æ–¥ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º, —á—Ç–æ–±—ã:
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ (Black)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã (isort)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (flake8)
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ YAML/JSON/TOML —Ñ–∞–π–ª–∞—Ö
- ‚úÖ –£–¥–∞–ª—è—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pre-commit
pip install pre-commit

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ hooks –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
pre-commit install

# 3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
pre-commit run --all-files
```

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å hooks –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º `git commit`.

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –û–±—ã—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞

–ü—Ä–æ—Å—Ç–æ –∫–æ–º–º–∏—Ç—å—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ - hooks –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```bash
git add .
git commit -m "Your changes"
```

–ï—Å–ª–∏ hooks –Ω–∞–π–¥—É—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ–º—ã–µ** (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) - –±—É–¥—É—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∫–æ–º–º–∏—Ç
- **–¢—Ä–µ–±—É—é—â–∏–µ —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è** (–æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞) - –∫–æ–º–º–∏—Ç –±—É–¥–µ—Ç –æ—Ç–º–µ–Ω–µ–Ω, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∫–æ–º–º–∏—Ç

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –î–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
pre-commit run --all-files

# –¢–æ–ª—å–∫–æ –¥–ª—è staged —Ñ–∞–π–ª–æ–≤
pre-commit run

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π hook (–Ω–∞–ø—Ä–∏–º–µ—Ä, black)
pre-commit run black --all-files
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å hooks
pre-commit install

# –£–¥–∞–ª–∏—Ç—å hooks
pre-commit uninstall

# –û–±–Ω–æ–≤–∏—Ç—å hooks –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π
pre-commit autoupdate

# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å hooks –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!)
git commit --no-verify
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Python –∫–æ–¥–∞ (Black)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ (isort)
- ‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ (flake8)
- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å YAML/JSON/TOML
- ‚úÖ –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
- ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (pdb, ipdb)
- ‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–ª–∏—è–Ω–∏—è
- ‚úÖ –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (>1MB)

## –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

```bash
$ git add rhizome/node/base_node.py
$ git commit -m "Update node"
black....................................................Passed
isort....................................................Passed
flake8...................................................Failed
- hook id: flake8
- exit code: 1

rhizome/node/base_node.py:45:1: F401 'os' imported but unused

$ # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫—É
$ git add rhizome/node/base_node.py
$ git commit -m "Update node"
black....................................................Passed
isort....................................................Passed
flake8...................................................Passed
[master abc1234] Update node
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üìñ [–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](.pre-commit-install.md)
- üåê [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç pre-commit](https://pre-commit.com/)
- üìã [–î–æ—Å—Ç—É–ø–Ω—ã–µ hooks](https://pre-commit.com/hooks.html)

