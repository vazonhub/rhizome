# GitHub Actions Workflows

Этот репозиторий использует GitHub Actions для автоматизации процессов разработки.

## Workflows

### 1. CI (`ci.yml`)

Основной workflow для непрерывной интеграции. Запускается при:
- Push в ветки `main`, `master`, `develop`
- Создании Pull Request в эти ветки

**Задачи:**
- **test**: Запускает тесты на Python 3.10, 3.11, 3.12 на Ubuntu и macOS
  - Устанавливает системные зависимости (LMDB)
  - Устанавливает зависимости проекта
  - Запускает pytest с покрытием кода
  - Загружает отчет о покрытии в Codecov (для Python 3.11 на Ubuntu)
  
- **lint**: Проверка качества кода
  - Проверка форматирования с Black
  - Проверка сортировки импортов с isort
  - Линтинг с flake8
  - Проверка типов с mypy

- **build**: Сборка пакета
  - Создает wheel и source distribution
  - Проверяет содержимое пакета
  - Сохраняет артефакты сборки

- **integration-tests**: Интеграционные тесты
  - Запускает расширенные тесты взаимодействия узлов
  - Создает тестовую конфигурацию

### 2. Release (`release.yml`)

Workflow для публикации релизов. Запускается при:
- Создании нового релиза в GitHub
- Ручном запуске (workflow_dispatch)

**Задачи:**
- **build-and-publish**: Сборка и публикация в PyPI
  - Собирает пакет
  - Проверяет пакет с twine check
  - Публикует в PyPI (требуется секрет `PYPI_API_TOKEN`)

## Настройка

### Секреты

Для работы release workflow требуется настроить секрет в настройках репозитория:

1. Перейдите в Settings → Secrets and variables → Actions
2. Добавьте новый секрет:
   - **PYPI_API_TOKEN**: API токен PyPI для публикации пакетов

### Codecov

Для загрузки отчетов о покрытии кода:

1. Подключите репозиторий к Codecov (codecov.io)
2. Добавьте токен Codecov в секреты (опционально, если требуется)

## Локальная проверка

Все проверки можно запустить локально с помощью Makefile:

```bash
# Тесты
make test

# Линтинг
make lint

# Форматирование
make format

# Сборка
python -m build
```

## Матрица тестирования

Проект тестируется на:
- Python: 3.10, 3.11, 3.12
- ОС: Ubuntu Latest, macOS Latest

